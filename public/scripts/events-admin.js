"use strict";function renderEventsTable(){knucklebone.getJson("/get/events").success(function(e){console.log("json res:",e),dom("events-table-cont").purge();var t=document.createDocumentFragment();_.each(e,function(e){t.appendChild(createTableItem(e))}),dom("events-table-cont").append(t)}).error(function(){dom("events-table-cont").purge().append(createTableItem({name:"BYU Hack Night",place:"484 Tanner Building",time:"Thursdays 7-10pm",description:"Hack with others"}))})}function createTableItem(e){e.date=e.date.replace(/-/g,"/");var t=dom.create("div").addClass("table-cont"),n=getDay(e.date),r=new Date(e.date).getDate(),a=getMonth(e.date);e.date=e.date||"",e.time=e.time||"";var o=dom.create("table").addClass("event-table").append(dom.create("tr").addClass("event-info").append(dom.create("td").addClass("event-name").text(e.name),dom.create("td").addClass("event-place").text(e.place),dom.create("td").addClass("event-time").text(n+", "+a+" "+r+". "+e.time)),dom.create("tr").addClass("event-description").append(dom.create("td").addClass("event-description").attr("colspan",3).text(e.description)));return t.append(dom.create("div").addClass("delete-event").text("x").attr("data-id",e.id).listen("click",function(){"function"==typeof deleteEvent&&deleteEvent(this.dataset.id)})),t.append(o)}function getDay(e){var t=new Date(e).getDay(),n={0:"Sun",1:"Mon",2:"Tue",3:"Wed",4:"Thur",5:"Fri",6:"Sat"};return n[t]}function getMonth(e){var t=new Date(e).getMonth(),n={0:"Jan",1:"Feb",2:"Mar",3:"Apr",4:"May",5:"Jun",6:"Jul",7:"Aug",8:"Sep",9:"Oct",10:"Nov",11:"Dec"};return n[t]}function postEventsArray(e){knucklebone.postJson("/post/events",e).success(function(){renderEventsTable()}).error(function(e){alert("Error:"+e)})}function deleteEvent(e){knucklebone.getJson("/get/events").success(function(t){var n=t.filter(function(t){return t.id!==e});postEventsArray(n)}).error(function(e){alert("Error:"+e)})}function createNewEvent(){var e=knucklebone.formToObject("new-event-form");return e.id=rand(12,"special"),e}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},_={isArray:function(e){return"object"===("undefined"==typeof e?"undefined":_typeof(e))&&(Array.isArray&&Array.isArray(e)||e.constructor===Array||e instanceof Array)},each:function(e,t){if(!e||!e.length)return null;for(var n=0,r=e.length;r>n;n++)t(e[n],n)},map:function(e,t){if(!e||!e.length)return[];for(var n=[],r=0,a=e.length;a>r;r++)n.push(t(e[r]));return n},filter:function(e,t){if(!e||!e.length)return[];for(var n=[],r=0,a=e.length;a>r;r++)t(e[r])&&n.push(e[r]);return n},merge:function(){for(var e={},t=arguments.length,n=Array(t),r=0;t>r;r++)n[r]=arguments[r];return _.each(n,function(t){t&&"object"===("undefined"==typeof t?"undefined":_typeof(t))&&_.each(Object.keys(t),function(n){e[n]=t[n]})}),e},toArray:function(e){for(var t=this,n=arguments.length,r=Array(n>1?n-1:0),a=1;n>a;a++)r[a-1]=arguments[a];if(r&&r.length){var o=function(){var n=[];return n=n.concat(e),t.each(r,function(e){n=n.concat(e)}),{v:n}}();if("object"===("undefined"==typeof o?"undefined":_typeof(o)))return o.v}else{if(!e||!e.length)return[e];if(this.isArray(e))return e}for(var i=[],c=0,s=e.length;s>c;c++)i.push(e[c]);return i}},newEventForm=dom("new-event-form"),inputFields=dom.queryByClass("input-field").toArr();newEventForm.listen("submit",function(e){e.preventDefault();var t=!1,n="mm/dd/yyyy";_.each(inputFields,function(e){if(e.value.trim().length<=0&&(e.classList.add("error"),t=!0),"date"===e.getAttribute("name")){var r=e.value,a=new Date(r).toLocaleDateString().replace(/-/g,"/").split("/");if(console.log("arr",a),a.length<3)return t=!0,e.classList.add("error"),void alert("(checkpoint 1) date format is: "+n);if(console.log("dateValueArr[0]: ",a[0]),console.log("dateValueArr[0].length: ",a[0].length),2!==a[0].length)return t=!0,e.classList.add("error"),void alert("(checkpoint 2) date format is: "+n);if(2!==a[1].length)return t=!0,e.classList.add("error"),void alert("(checkpoint 3) date format is: "+n);if(4!==parseInt(a[2]).toString().length)return t=!0,e.classList.add("error"),void alert("(checkpoint 4) date format is: "+n)}}),t||!function(){var e=createNewEvent();knucklebone.getJson("/get/events").success(function(t){e.date=e.date.replace(/-/g,"/"),t.push(e),postEventsArray(t)}).error(function(e){alert("Error:"+e)})}()}),_.each(inputFields,function(e){e.addEventListener("focus",function(){this.classList.remove("error")})}),window.addEventListener("load",function(){return renderEventsTable()});
